<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>API Reference · SeqFISH_ADCG</title><meta name="title" content="API Reference · SeqFISH_ADCG"/><meta property="og:title" content="API Reference · SeqFISH_ADCG"/><meta property="twitter:title" content="API Reference · SeqFISH_ADCG"/><meta name="description" content="Documentation for SeqFISH_ADCG."/><meta property="og:description" content="Documentation for SeqFISH_ADCG."/><meta property="twitter:description" content="Documentation for SeqFISH_ADCG."/><script data-outdated-warner src="assets/warner.js"></script><link href="https://cdnjs.cloudflare.com/ajax/libs/lato-font/3.0.0/css/lato-font.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/juliamono/0.050/juliamono.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.2/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.16.8/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="search_index.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-mocha.css" data-theme-name="catppuccin-mocha"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-macchiato.css" data-theme-name="catppuccin-macchiato"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-frappe.css" data-theme-name="catppuccin-frappe"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/catppuccin-latte.css" data-theme-name="catppuccin-latte"/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit"><a href="index.html">SeqFISH_ADCG</a></span></div><button class="docs-search-query input is-rounded is-small is-clickable my-2 mx-auto py-1 px-2" id="documenter-search-query">Search docs (Ctrl + /)</button><ul class="docs-menu"><li><a class="tocitem" href="index.html">SeqFISH_ADCG.jl</a></li><li><a class="tocitem" href="installation.html">Installation</a></li><li><a class="tocitem" href="example_FitDots.html">Example Fitting with ADCG</a></li><li class="is-active"><a class="tocitem" href="api_reference.html">API Reference</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><a class="docs-sidebar-button docs-navbar-link fa-solid fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="api_reference.html">API Reference</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="api_reference.html">API Reference</a></li></ul></nav><div class="docs-right"><a class="docs-navbar-link" href="https://github.com/CaiGroup/SeqFISH_ADCG" title="View the repository on GitHub"><span class="docs-icon fa-brands"></span><span class="docs-label is-hidden-touch">GitHub</span></a><a class="docs-navbar-link" href="https://github.com/CaiGroup/SeqFISH_ADCG/blob/master/docs/src/api_reference.md" title="Edit source on GitHub"><span class="docs-icon fa-solid"></span></a><a class="docs-settings-button docs-navbar-link fa-solid fa-gear" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-article-toggle-button fa-solid fa-chevron-up" id="documenter-article-toggle-button" href="javascript:;" title="Collapse all docstrings"></a></div></header><article class="content" id="documenter-page"><h1 id="API-Reference"><a class="docs-heading-anchor" href="#API-Reference">API Reference</a><a id="API-Reference-1"></a><a class="docs-heading-anchor-permalink" href="#API-Reference" title="Permalink"></a></h1><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFISH_ADCG.fit_img_tiles" href="#SeqFISH_ADCG.fit_img_tiles"><code>SeqFISH_ADCG.fit_img_tiles</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_img_tiles(img,
              main_tile_width :: Int64,
              tile_overlap :: Int64,
              sigma_lb :: Float64,
              sigma_ub :: Float64,
              tau :: Float64,
              final_loss_improvement :: Float64,
              min_weight :: Float64,
              max_iters :: Int64,
              max_cd_iters :: Int64,
                noise_mean :: Float64
            )</code></pre><p>Run ADCG on a square image of arbitrar sized pixel image by breaking it up into overlapping tiles of user specified width and overlap, then running ADCG on each tile and aggregating the results It is necessary to call remove duplicates on the resultant image to remove the duplicates in the regions of overlapping tiles.</p><p>Arguments:</p><ul><li><code>img</code> : a 2048x2048 image to fit</li><li><code>main_tile_width</code> : the width of the main tile </li><li><code>tile_overlap</code> : width of the overlaps of tiles with their neighbors </li><li><code>sigma_lb</code> : the lowest allowed σ of a PSF</li><li><code>sigma_ub</code> : the highest allowed σ of a PSF</li><li><code>tau</code> : not used in current version</li><li><code>final_loss_improvement</code> : ADCG terminates when the improvement in the loss function in subsequent iterations is less than this</li><li><code>min_weight</code> : ADCG terminates when the next best PSF to add to the model has weight less than this</li><li><code>max_cd_iters</code> : the maximum number of iterations of gradient descent to run after adding a PSF to the model to adjust the parameters of all PSFs in the model</li><li><code>noise_mean</code> : the noise mean is subtracted from the image before fitting</li><li><code>fit_alg</code> : &#39;ADCG&#39; or &#39;DAO&#39;, uses the respective algorithm. Only ADCG is thorougly tested. Must be set as a keyword argument.</li></ul><p>Fits gaussian point spread functions in an arbitrarily sizedsquare image with ADCG by splitting it into overlapping pixel tiles of user specified size. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CaiGroup/SeqFISH_ADCG/blob/f66c0629d60df15b9f5399b6d6e53772c0e9c429/src/fit_2048x2048_img.jl#L131-L163">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFISH_ADCG.fit_2048x2048_img_tiles" href="#SeqFISH_ADCG.fit_2048x2048_img_tiles"><code>SeqFISH_ADCG.fit_2048x2048_img_tiles</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_2048x2048_img_tiles(img,
                        sigma_lb :: Float64,
                        sigma_ub :: Float64,
                        tau :: Float64,
                        final_loss_improvement :: Float64,
                        min_weight :: Float64,
                        max_iters :: Int64,
                        max_cd_iters :: Int64,
                        noise_mean :: Float64,
                        fit_alg :: AbstractString = &quot;ADCG&quot;
                        )</code></pre><p>Arguments:</p><ul><li><code>img</code> : a 2048x2048 image to fit </li><li><code>sigma_lb</code> : the lowest allowed σ of a PSF</li><li><code>sigma_ub</code> : the highest allowed σ of a PSF</li><li><code>tau</code> : not used in current version</li><li><code>final_loss_improvement</code> : ADCG terminates when the improvement in the loss function in subsequent iterations is less than this</li><li><code>min_weight</code> : ADCG terminates when the next best PSF to add to the model has weight less than this</li><li><code>max_cd_iters</code> : the maximum number of iterations of gradient descent to run after adding a PSF to the model to adjust the parameters of all PSFs in the model</li><li><code>noise_mean</code> : the noise mean is subtracted from the image before fitting</li><li><code>fit_alg</code> : &#39;ADCG&#39; or &#39;DAO&#39;, uses the respective algorithm. Only ADCG is thorougly tested. Must be set as a keyword argument.</li></ul><p>Fits gaussian point spread functions in a 2048x2048 pixel image with ADCG by splitting it into overlapping 70x70 pixel tiles. </p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CaiGroup/SeqFISH_ADCG/blob/f66c0629d60df15b9f5399b6d6e53772c0e9c429/src/fit_2048x2048_img.jl#L83-L109">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFISH_ADCG.remove_duplicates" href="#SeqFISH_ADCG.remove_duplicates"><code>SeqFISH_ADCG.remove_duplicates</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">remove_duplicates(points :: DataFrame,
                img,
                sigma_lb :: Float64,
                sigma_ub :: Float64,
                tau :: Float64,
                noise_mean :: Float64,
                min_allowed_separation :: Float64,
                dims :: Int64 = 2
                )

Removes duplicates within min_allowed_separtion of each other from an image.
This is necessary when fit by a tiled ADCG where the tiles overlap.</code></pre></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CaiGroup/SeqFISH_ADCG/blob/f66c0629d60df15b9f5399b6d6e53772c0e9c429/src/fit_2048x2048_img.jl#L225-L238">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFISH_ADCG.fit_tile" href="#SeqFISH_ADCG.fit_tile"><code>SeqFISH_ADCG.fit_tile</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_tile(inputs)</code></pre><p>Arguments:</p><ul><li><code>inputs</code> : A tuple of inputs with entries:<ul><li><code>tile</code> : An image tile to perform ADCG on.</li><li><code>sigma_lb</code> : the lowest allowed value of the width parameter of dots.</li><li><code>sigma_ub</code> : the highest allowed value of the width parameter of dots.</li><li><code>noise_mean</code> : estimated mean of noise. Pixel values below this are set to zero.</li><li><code>tau</code> : not used in this version</li><li><code>final_loss_improvement</code> : Terminate ADCG when the objective improves by less than this value in one iteration</li><li><code>min_weight</code> : The minimum allowed weight of a PSF in the image model</li><li><code>max_iters</code> : The maximum number of ADCG iterations, or number PSFs to add to the model.</li><li><code>max_cd_iterations</code> : the maximum number of times to perform gradient descent for the parameter values of all dots.</li><li><code>fit_alg</code> : &#39;ADCG&#39; or &#39;DAO&#39;, uses the respective algorithm. Only ADCG is thorougly tested.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CaiGroup/SeqFISH_ADCG/blob/f66c0629d60df15b9f5399b6d6e53772c0e9c429/src/fit_2048x2048_img.jl#L10-L25">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFISH_ADCG.fit_stack" href="#SeqFISH_ADCG.fit_stack"><code>SeqFISH_ADCG.fit_stack</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_tile(inputs)</code></pre><p>Arguments:</p><ul><li><code>inputs</code> : A tuple of inputs with entries:<ul><li><code>tile</code> : An image tile to perform ADCG on.</li><li><code>sigma_lb</code> : the lowest allowed value of the width parameter of dots.</li><li><code>sigma_ub</code> : the highest allowed value of the width parameter of dots.</li><li><code>noise_mean</code> : estimated mean of noise. Pixel values below this are set to zero.</li><li><code>tau</code> : not used in this version</li><li><code>final_loss_improvement</code> : Terminate ADCG when the objective improves by less than this value in one iteration</li><li><code>min_weight</code> : The minimum allowed weight of a PSF in the image model</li><li><code>max_iters</code> : The maximum number of ADCG iterations, or number PSFs to add to the model.</li><li><code>max_cd_iterations</code> : the maximum number of times to perform gradient descent for the parameter values of all dots.</li><li><code>fit_alg</code> : &#39;ADCG&#39; or &#39;DAO&#39;, uses the respective algorithm. Only ADCG is thorougly tested. Must be set as a keyword argument.</li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CaiGroup/SeqFISH_ADCG/blob/f66c0629d60df15b9f5399b6d6e53772c0e9c429/src/fit_3d.jl#L5-L20">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFISH_ADCG.fit_stack_tiles" href="#SeqFISH_ADCG.fit_stack_tiles"><code>SeqFISH_ADCG.fit_stack_tiles</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">fit_stack_tiles(
                   img_stack,
                   main_tile_width :: Int64,
                   tile_overlap :: Int64,
                   tile_depth :: Int64,
                   tile_depth_overhang :: Int64,
                   sigma_xy_lb :: Float64,
                   sigma_xy_ub :: Float64,
                   sigma_z_lb :: Float64,
                   sigma_z_ub :: Float64,
                   final_loss_improvement :: Float64,
                   min_weight :: Float64,
                   max_iters :: Int64,
                   max_cd_iters :: Int64,
                   fit_alg = &quot;ADCG&quot;
            )</code></pre><p>Run ADCG on a square image of arbitrar sized pixel image by breaking it up into overlapping tiles of user specified width and overlap, then running ADCG on each tile and aggregating the results It is necessary to call remove duplicates on the resultant image to remove the duplicates in the regions of overlapping tiles.</p><p>Arguments:</p><ul><li><code>img</code> : a 2048x2048 image to fit</li><li><code>main_tile_width</code> : the width of the main tile </li><li><code>tile_overlap</code> : width of the overlaps of tiles with their neighbors </li><li><code>sigma_xy_lb</code> : the lowest allowed lateral σ of a PSF</li><li><code>sigma_xy_ub</code> : the highest allowed lateral σ of a PSF</li><li><code>sigma_z_lb</code> : the lowest allowed axial σ of a PSF</li><li><code>sigma_z_ub</code> : the highest allowed axial σ of a PSF</li><li><code>final_loss_improvement</code> : ADCG terminates when the improvement in the loss function in subsequent iterations is less than this</li><li><code>min_weight</code> : ADCG terminates when the next best PSF to add to the model has weight less than this</li><li><code>max_iters</code> : the maximum number of iterations in which a new PSF may be added to the model of a tile (i.e. the maximum PSFs in a tile)</li><li><code>max_cd_iters</code> : the maximum number of iterations of gradient descent to run after adding a PSF to the model to adjust the parameters of all PSFs in the model</li><li><code>noise_mean</code> : the noise mean is subtracted from the image before fitting</li><li><code>fit_alg</code> : &#39;ADCG&#39; or &#39;DAO&#39;, uses the respective algorithm. Only ADCG is thorougly tested. Must be set as a keyword argument.</li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CaiGroup/SeqFISH_ADCG/blob/f66c0629d60df15b9f5399b6d6e53772c0e9c429/src/fit_3d.jl#L64-L99">source</a></section></article><article class="docstring"><header><a class="docstring-article-toggle-button fa-solid fa-chevron-down" href="javascript:;" title="Collapse docstring"></a><a class="docstring-binding" id="SeqFISH_ADCG.get_mw_dots" href="#SeqFISH_ADCG.get_mw_dots"><code>SeqFISH_ADCG.get_mw_dots</code></a> — <span class="docstring-category">Function</span><span class="is-flex-grow-1 docstring-article-toggle-button" title="Collapse docstring"></span></header><section><div><pre><code class="language-julia hljs">get_mw_dots(records :: DataFrame, w :: Real)</code></pre><p>Look up the ADCG result at a minimum weight larger than the final minimum weight given for an ADCG run.</p><p>Returns a dataframe of results.</p></div><a class="docs-sourcelink" target="_blank" href="https://github.com/CaiGroup/SeqFISH_ADCG/blob/f66c0629d60df15b9f5399b6d6e53772c0e9c429/src/DotRecords.jl#L11-L17">source</a></section></article></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="example_FitDots.html">« Example Fitting with ADCG</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="auto">Automatic (OS)</option><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option><option value="catppuccin-latte">catppuccin-latte</option><option value="catppuccin-frappe">catppuccin-frappe</option><option value="catppuccin-macchiato">catppuccin-macchiato</option><option value="catppuccin-mocha">catppuccin-mocha</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> version 1.8.0 on <span class="colophon-date" title="Monday 7 April 2025 13:49">Monday 7 April 2025</span>. Using Julia version 1.11.2.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
